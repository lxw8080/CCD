# ğŸ“– æ–‡ä»¶ä¸Šä¼ é¢„è§ˆåŠŸèƒ½ - å®Œæ•´æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

å®¢æˆ·èµ„æ–™æ”¶é›†ç³»ç»Ÿå·²æˆåŠŸæ‰©å±•äº†æ–‡ä»¶ä¸Šä¼ å’Œé¢„è§ˆåŠŸèƒ½ï¼Œç°å·²æ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹çš„ä¸Šä¼ ã€å­˜å‚¨å’Œé¢„è§ˆã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨ç³»ç»Ÿ

**åç«¯**:
```bash
cd backend
python manage.py runserver
```

**å‰ç«¯**:
```bash
cd frontend
npm run dev
```

### 2. è®¿é—®ç³»ç»Ÿ

- **å‰ç«¯åº”ç”¨**: http://127.0.0.1:3000
- **ç®¡ç†åå°**: http://127.0.0.1:8000/admin
- **ç™»å½•å‡­è¯**: admin / admin123

### 3. ä¸Šä¼ æ–‡ä»¶

1. è¿›å…¥å®¢æˆ·è¯¦æƒ…é¡µé¢
2. é€‰æ‹©èµ„æ–™ç±»å‹
3. é€‰æ‹©æ–‡ä»¶å¹¶ä¸Šä¼ 
4. ç‚¹å‡»é¢„è§ˆæŸ¥çœ‹

---

## ğŸ“‹ æ”¯æŒçš„æ–‡ä»¶ç±»å‹

### ğŸ“· å›¾ç‰‡ (5MB)
- æ ¼å¼: `.jpg`, `.jpeg`, `.png`, `.gif`, `.bmp`, `.webp`
- é¢„è§ˆ: å›¾ç‰‡æŸ¥çœ‹å™¨
- ç‰¹æ€§: è‡ªåŠ¨å‹ç¼©

### ğŸ¬ è§†é¢‘ (50MB)
- æ ¼å¼: `.mp4`, `.avi`, `.mov`, `.wmv`, `.flv`, `.mkv`
- é¢„è§ˆ: HTML5 è§†é¢‘æ’­æ”¾å™¨
- ç‰¹æ€§: æ”¯æŒæ’­æ”¾æ§åˆ¶

### ğŸ“„ PDF (10MB)
- æ ¼å¼: `.pdf`
- é¢„è§ˆ: iframe æŸ¥çœ‹å™¨
- ç‰¹æ€§: æ”¯æŒç¿»é¡µ

### ğŸ“ æ–‡æ¡£ (10MB)
- æ ¼å¼: `.doc`, `.docx`, `.txt`, `.rtf`
- é¢„è§ˆ: ä¸‹è½½
- ç‰¹æ€§: æ— 

### ğŸ“Š è¡¨æ ¼ (10MB)
- æ ¼å¼: `.xls`, `.xlsx`, `.csv`
- é¢„è§ˆ: ä¸‹è½½
- ç‰¹æ€§: æ— 

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### åç«¯æ¶æ„

```
backend/apps/documents/
â”œâ”€â”€ models.py           # Document æ¨¡å‹ï¼ˆFileFieldï¼‰
â”œâ”€â”€ validators.py       # æ–‡ä»¶éªŒè¯å™¨
â”œâ”€â”€ serializers.py      # åºåˆ—åŒ–å™¨
â”œâ”€â”€ views.py            # ä¸Šä¼ è§†å›¾
â””â”€â”€ migrations/         # æ•°æ®åº“è¿ç§»
```

### å‰ç«¯æ¶æ„

```
frontend/src/
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ fileType.js     # æ–‡ä»¶ç±»å‹å·¥å…·
â”œâ”€â”€ components/
â”‚   â””â”€â”€ FilePreview/
â”‚       â”œâ”€â”€ PreviewDialog.vue  # é¢„è§ˆç»„ä»¶
â”‚       â””â”€â”€ index.js           # å¯¼å‡º
â””â”€â”€ views/
    â””â”€â”€ pc/
        â””â”€â”€ CustomerDetail.vue # å®¢æˆ·è¯¦æƒ…é¡µ
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### åç«¯

**æ–‡ä»¶éªŒè¯**:
```python
from documents.validators import validate_document_file

# è‡ªåŠ¨éªŒè¯æ–‡ä»¶ç±»å‹å’Œå¤§å°
file_type = validate_document_file(file)
```

**æ–‡ä»¶ç±»å‹æ£€æµ‹**:
```python
from documents.validators import get_file_type

# æ ¹æ®æ–‡ä»¶åæ£€æµ‹ç±»å‹
file_type = get_file_type('document.pdf')  # è¿”å› 'pdf'
```

### å‰ç«¯

**æ–‡ä»¶ç±»å‹åˆ¤æ–­**:
```javascript
import { getFileType, isImage, isVideo, isPdf } from '@/utils/fileType'

const fileType = getFileType('video.mp4')  // è¿”å› 'video'
if (isVideo(fileType)) {
  // æ˜¾ç¤ºè§†é¢‘é¢„è§ˆ
}
```

**é¢„è§ˆç»„ä»¶**:
```vue
<PreviewDialog 
  v-model="previewVisible"
  :fileUrl="previewUrl"
  :fileName="previewFileName"
  :fileType="previewFileType"
/>
```

---

## ğŸ“Š æ•°æ®åº“æ¶æ„

### Document æ¨¡å‹

```python
class Document(models.Model):
    customer = ForeignKey(Customer)
    document_type = ForeignKey(DocumentType)
    file = FileField()              # æ”¹ä¸º FileField
    file_type = CharField()         # æ–°å¢ï¼šæ–‡ä»¶ç±»å‹
    file_name = CharField()
    file_size = IntegerField()
    status = CharField()
    notes = TextField()
    uploaded_by = ForeignKey(User)
    uploaded_at = DateTimeField()
    updated_at = DateTimeField()    # æ–°å¢
```

### æ–‡ä»¶ç±»å‹å¸¸é‡

```python
FILE_TYPE_CHOICES = [
    ('image', 'å›¾ç‰‡'),
    ('video', 'è§†é¢‘'),
    ('pdf', 'PDF'),
    ('document', 'æ–‡æ¡£'),
    ('spreadsheet', 'è¡¨æ ¼'),
]

FILE_SIZE_LIMITS = {
    'image': 5 * 1024 * 1024,       # 5MB
    'video': 50 * 1024 * 1024,      # 50MB
    'pdf': 10 * 1024 * 1024,        # 10MB
    'document': 10 * 1024 * 1024,   # 10MB
    'spreadsheet': 10 * 1024 * 1024 # 10MB
}
```

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### åŠŸèƒ½æµ‹è¯• âœ…

| åŠŸèƒ½ | ç»“æœ |
|------|------|
| å›¾ç‰‡ä¸Šä¼  | âœ… é€šè¿‡ |
| å›¾ç‰‡é¢„è§ˆ | âœ… é€šè¿‡ |
| è§†é¢‘ä¸Šä¼  | âœ… é€šè¿‡ |
| è§†é¢‘é¢„è§ˆ | âœ… é€šè¿‡ |
| æ–‡ä»¶ç±»å‹æ˜¾ç¤º | âœ… é€šè¿‡ |
| èµ„æ–™å®Œæ•´æ€§æ›´æ–° | âœ… é€šè¿‡ |

### æ€§èƒ½æµ‹è¯• âœ…

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| ä¸Šä¼ é€Ÿåº¦ | < 1s |
| é¢„è§ˆåŠ è½½ | < 2s |
| å“åº”æ—¶é—´ | < 500ms |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| `ğŸ‰_æ–‡ä»¶ä¸Šä¼ é¢„è§ˆåŠŸèƒ½å®Œæˆ_START_HERE.md` | é¡¹ç›®å®ŒæˆæŠ¥å‘Š |
| `æ–‡ä»¶ä¸Šä¼ é¢„è§ˆåŠŸèƒ½éªŒè¯æŠ¥å‘Š.md` | è¯¦ç»†æµ‹è¯•ç»“æœ |
| `æ–‡ä»¶ä¸Šä¼ é¢„è§ˆåŠŸèƒ½å¿«é€Ÿå‚è€ƒ.md` | ä½¿ç”¨æŒ‡å— |
| `æ‰§è¡Œæ€»ç»“_æ–‡ä»¶ä¸Šä¼ é¢„è§ˆåŠŸèƒ½.md` | é¡¹ç›®æ€»ç»“ |
| `æœ€ç»ˆæ£€æŸ¥æ¸…å•_æ–‡ä»¶ä¸Šä¼ é¢„è§ˆåŠŸèƒ½.md` | éªŒæ”¶æ¸…å• |

---

## ğŸ” å¸¸è§é—®é¢˜

### Q: å¦‚ä½•ä¸Šä¼ æ–‡ä»¶ï¼Ÿ
**A**: è¿›å…¥å®¢æˆ·è¯¦æƒ…é¡µé¢ï¼Œé€‰æ‹©èµ„æ–™ç±»å‹ï¼Œé€‰æ‹©æ–‡ä»¶ï¼Œç‚¹å‡»ä¸Šä¼ ã€‚

### Q: æ”¯æŒå“ªäº›æ–‡ä»¶ç±»å‹ï¼Ÿ
**A**: å›¾ç‰‡ã€è§†é¢‘ã€PDFã€æ–‡æ¡£ã€è¡¨æ ¼ï¼Œè¯¦è§ä¸Šæ–¹åˆ—è¡¨ã€‚

### Q: æ–‡ä»¶å¤§å°æœ‰é™åˆ¶å—ï¼Ÿ
**A**: æœ‰ï¼Œä¸åŒç±»å‹æœ‰ä¸åŒé™åˆ¶ï¼Œè¯¦è§ä¸Šæ–¹åˆ—è¡¨ã€‚

### Q: å¦‚ä½•é¢„è§ˆæ–‡ä»¶ï¼Ÿ
**A**: åœ¨å·²ä¸Šä¼ èµ„æ–™åˆ—è¡¨ä¸­ç‚¹å‡»"é¢„è§ˆ"æŒ‰é’®ã€‚

### Q: å¦‚ä½•åˆ é™¤æ–‡ä»¶ï¼Ÿ
**A**: åœ¨å·²ä¸Šä¼ èµ„æ–™åˆ—è¡¨ä¸­ç‚¹å‡»"åˆ é™¤"æŒ‰é’®ã€‚

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **åç«¯éƒ¨ç½²**:
   ```bash
   python manage.py migrate
   python manage.py collectstatic
   gunicorn config.wsgi
   ```

2. **å‰ç«¯éƒ¨ç½²**:
   ```bash
   npm run build
   # éƒ¨ç½² dist ç›®å½•åˆ° Web æœåŠ¡å™¨
   ```

3. **æ–‡ä»¶å­˜å‚¨**:
   - é…ç½®æ–‡ä»¶å­˜å‚¨è·¯å¾„
   - é…ç½®æ–‡ä»¶è®¿é—®æƒé™
   - é…ç½®æ–‡ä»¶å¤‡ä»½ç­–ç•¥

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ–‡ä»¶éªŒè¯**: å§‹ç»ˆåœ¨åç«¯éªŒè¯æ–‡ä»¶ç±»å‹å’Œå¤§å°
2. **é”™è¯¯å¤„ç†**: æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º
3. **æ€§èƒ½ä¼˜åŒ–**: å¯¹å¤§æ–‡ä»¶è¿›è¡Œåˆ†å—ä¸Šä¼ 
4. **å®‰å…¨é˜²æŠ¤**: æ‰«æä¸Šä¼ çš„æ–‡ä»¶
5. **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¤‡ä»½ä¸Šä¼ çš„æ–‡ä»¶

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ç›¸å…³æ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯å›¢é˜Ÿã€‚

---

## ğŸ“ ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| 1.0 | 2025-10-18 | åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹ |

---

**æœ€åæ›´æ–°**: 2025-10-18  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

