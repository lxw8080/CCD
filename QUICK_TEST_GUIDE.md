# 申请日期默认值功能 - 快速测试指南

## 🚀 快速测试步骤

### 1. 启动后端服务
```bash
cd backend
python manage.py runserver
```

### 2. 启动前端服务
```bash
cd frontend
npm run dev
```

### 3. 访问前端应用
打开浏览器访问: http://localhost:3000

### 4. 测试新建客户功能

#### 步骤：
1. 登录系统（如果需要）
2. 导航到: **客户管理** > **新建客户**
3. 观察"申请日期"字段

#### 预期结果：
✅ "申请日期"字段应该自动显示今天的日期（例如：2025-10-21）

#### 截图位置：
- PC 端: 在表单的自定义字段区域
- 移动端: 在表单的自定义字段区域

### 5. 测试修改功能

#### 步骤：
1. 点击"申请日期"字段
2. 选择其他日期
3. 确认可以正常修改

#### 预期结果：
✅ 可以正常选择和修改日期

### 6. 测试提交功能

#### 步骤：
1. 填写所有必填字段：
   - 姓名
   - 身份证号
   - 手机号
   - 地址
   - 状态
   - 产品（自定义字段）
   - 贷款金额（自定义字段）
   - 申请日期（自定义字段，已自动填充）
2. 点击"提交"按钮

#### 预期结果：
✅ 客户创建成功
✅ "申请日期"字段保存为选择的日期

### 7. 测试编辑功能

#### 步骤：
1. 打开刚创建的客户
2. 点击"编辑"
3. 观察"申请日期"字段

#### 预期结果：
✅ "申请日期"字段显示之前保存的日期
✅ 不会被今天的日期覆盖

---

## 🔍 验证检查清单

### 后端验证
- [ ] 数据库中"申请日期"字段的 `default_value` 为 `"TODAY"`
  ```bash
  cd backend
  python verify_default_value.py
  ```

### 前端验证（PC 端）
- [ ] 打开新建客户表单
- [ ] "申请日期"字段自动显示今天的日期
- [ ] 可以修改日期
- [ ] 提交后数据正确保存
- [ ] 编辑时显示已保存的日期

### 前端验证（移动端）
- [ ] 在移动设备或浏览器移动模式下测试
- [ ] "申请日期"字段自动显示今天的日期
- [ ] 可以修改日期
- [ ] 提交后数据正确保存
- [ ] 编辑时显示已保存的日期

---

## 🐛 常见问题排查

### 问题1: "申请日期"字段没有自动填充

**可能原因**:
1. 前端代码未更新
2. 浏览器缓存

**解决方案**:
```bash
# 清除浏览器缓存并刷新页面
# 或者强制刷新: Ctrl + F5 (Windows) / Cmd + Shift + R (Mac)

# 重新启动前端服务
cd frontend
npm run dev
```

### 问题2: 日期格式不正确

**检查**:
- 日期应该是 `YYYY-MM-DD` 格式（例如：2025-10-21）
- 不应该包含时间部分

**解决方案**:
- 检查前端代码中的日期格式化逻辑
- 查看浏览器控制台是否有错误

### 问题3: 编辑客户时日期被覆盖

**预期行为**:
- 编辑客户时，应该显示已保存的日期
- 不应该被今天的日期覆盖

**检查代码**:
```javascript
// 应该有这个条件判断
if (field.default_value && !form.custom_fields[field.id]) {
  // 只在字段为空时设置默认值
}
```

---

## 📊 测试数据示例

### 新建客户测试数据

```json
{
  "name": "测试客户",
  "id_card": "110101199001011234",
  "phone": "13800138000",
  "address": "北京市朝阳区",
  "status": "pending",
  "custom_fields": {
    "1": "个人贷款",        // 产品
    "2": "50",              // 贷款金额
    "3": "2025-10-21"       // 申请日期（自动填充）
  }
}
```

---

## ✅ 测试完成确认

测试完成后，请确认以下事项：

- [ ] 新建客户时，"申请日期"自动填充为今天的日期
- [ ] 可以修改默认日期
- [ ] 提交后数据正确保存
- [ ] 编辑客户时，显示已保存的日期（不被覆盖）
- [ ] PC 端和移动端都正常工作
- [ ] 没有控制台错误

---

## 📞 需要帮助？

如果测试过程中遇到问题：

1. 检查浏览器控制台是否有错误
2. 检查后端日志
3. 运行验证脚本: `python verify_default_value.py`
4. 查看详细文档: `APPLICATION_DATE_DEFAULT_VALUE.md`

---

**测试指南版本**: 1.0  
**创建日期**: 2025-10-21

