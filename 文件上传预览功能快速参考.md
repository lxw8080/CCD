# 📖 文件上传预览功能快速参考

## 🎯 功能概览

客户资料收集系统现已支持多种文件类型的上传和预览。

---

## 📤 如何上传文件

### 步骤 1: 打开客户详情页面
1. 登录系统（admin / admin123）
2. 进入"客户资料管理"
3. 点击某个客户的"详情"按钮

### 步骤 2: 选择资料类型
1. 在"上传资料"区域，点击"资料类型"下拉框
2. 选择要上传的资料类型（如"身份证正面"）

### 步骤 3: 选择文件
1. 点击上传区域或拖拽文件
2. 选择要上传的文件
3. 支持的文件类型会自动识别

### 步骤 4: 上传
1. 点击"上传"按钮
2. 等待上传完成
3. 系统会自动刷新资料列表

---

## 👁️ 如何预览文件

### 图片预览
1. 在"已上传资料"列表中找到图片文件
2. 点击"预览"按钮
3. 在弹窗中查看图片

### 视频预览
1. 在"已上传资料"列表中找到视频文件
2. 点击"预览"按钮
3. 在弹窗中使用视频播放器
4. 支持播放/暂停/音量调整

### PDF预览
1. 在"已上传资料"列表中找到 PDF 文件
2. 点击"预览"按钮
3. 在弹窗中查看 PDF 内容

### 其他文件下载
1. 对于不支持预览的文件类型
2. 点击"预览"按钮
3. 点击"下载文件"按钮下载

---

## 📋 支持的文件类型

### 📷 图片 (5MB)
- 扩展名: `.jpg`, `.jpeg`, `.png`, `.gif`, `.bmp`, `.webp`
- 预览方式: 图片查看器
- 特殊处理: 自动压缩

### 🎬 视频 (50MB)
- 扩展名: `.mp4`, `.avi`, `.mov`, `.wmv`, `.flv`, `.mkv`
- 预览方式: HTML5 视频播放器
- 特殊处理: 无

### 📄 PDF (10MB)
- 扩展名: `.pdf`
- 预览方式: iframe 查看器
- 特殊处理: 无

### 📝 文档 (10MB)
- 扩展名: `.doc`, `.docx`, `.txt`, `.rtf`
- 预览方式: 下载
- 特殊处理: 无

### 📊 表格 (10MB)
- 扩展名: `.xls`, `.xlsx`, `.csv`
- 预览方式: 下载
- 特殊处理: 无

---

## ⚠️ 常见问题

### Q: 上传失败怎么办？
**A**: 检查以下几点：
- 文件大小是否超过限制
- 文件格式是否支持
- 网络连接是否正常

### Q: 预览不显示怎么办？
**A**: 
- 刷新页面重试
- 检查浏览器是否支持该文件格式
- 检查文件是否完整

### Q: 如何删除已上传的文件？
**A**: 
1. 在"已上传资料"列表中找到文件
2. 点击"删除"按钮
3. 确认删除

### Q: 可以上传多个文件吗？
**A**: 
- 可以，选择多个文件后点击"上传"
- 系统会逐个上传

---

## 🔧 技术细节

### 后端 API

**上传端点**: `POST /api/documents/upload/`

**请求参数**:
```json
{
  "customer": 5,
  "document_type": 1,
  "file": <File>
}
```

**响应示例**:
```json
{
  "id": 123,
  "file_name": "test.jpg",
  "file_size": 1024,
  "file_type": "image",
  "file_url": "http://...",
  "status": "pending"
}
```

### 前端组件

**文件类型工具**: `frontend/src/utils/fileType.js`
- `getFileType(filename)` - 检测文件类型
- `getFileTypeName(fileType)` - 获取中文名称
- `isImage()`, `isVideo()`, `isPdf()` - 类型判断

**预览组件**: `frontend/src/components/FilePreview/PreviewDialog.vue`
- 支持多种文件类型预览
- 自动选择预览方式

---

## 📞 获取帮助

如有问题，请查看以下文档：
- 📋 `文件上传预览功能验证报告.md` - 测试结果
- 📋 `文件上传预览功能扩展计划.md` - 实施细节

---

**最后更新**: 2025-10-18

